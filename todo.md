- [x] Test error handling.
- [ ] Alternative implementations
- [ ] Tweak high-level APIs:
  1. Remove prepare for now
  2. ?
